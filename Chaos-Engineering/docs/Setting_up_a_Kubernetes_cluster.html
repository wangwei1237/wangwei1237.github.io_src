
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>10.3 Setting up a Kubernetes cluster · Chaos Engineering</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="wangwei17">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Testing_out_software_running_on_Kubernetes.html" />
    
    
    <link rel="prev" href="Whats_Kubernetes_in_7_minutes.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://wangwei1237.gitee.io/" target="_blank" class="custom-link">17哥的个人网站</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">PART 3: Chaos Engineering beyond machines</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="Chaos_in_Kubernetes.html">
            
                <a href="Chaos_in_Kubernetes.html">
            
                    
                    10 Chaos in Kubernetes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="Porting_things_onto_Kubernetes.html">
            
                <a href="Porting_things_onto_Kubernetes.html">
            
                    
                    10.1 Porting things onto Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="Whats_Kubernetes_in_7_minutes.html">
            
                <a href="Whats_Kubernetes_in_7_minutes.html">
            
                    
                    10.2 What’s Kubernetes (in 7 minutes)
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.1.3" data-path="Setting_up_a_Kubernetes_cluster.html">
            
                <a href="Setting_up_a_Kubernetes_cluster.html">
            
                    
                    10.3 Setting up a Kubernetes cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="Testing_out_software_running_on_Kubernetes.html">
            
                <a href="Testing_out_software_running_on_Kubernetes.html">
            
                    
                    10.4 Testing out software running on Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="Summary_10.html">
            
                <a href="Summary_10.html">
            
                    
                    10.5 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Automating_Kubernetes_experiments.html">
            
                <a href="Automating_Kubernetes_experiments.html">
            
                    
                    11 Automating Kubernetes experiments
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="Automating_chaos_with_PowerfulSeal.html">
            
                <a href="Automating_chaos_with_PowerfulSeal.html">
            
                    
                    11.1 Automating chaos with PowerfulSeal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="Ongoing_testing_Service_Level_Objectives_SLOs.html">
            
                <a href="Ongoing_testing_Service_Level_Objectives_SLOs.html">
            
                    
                    11.2 Ongoing testing & Service Level Objectives (SLOs)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="Cloud_layer.html">
            
                <a href="Cloud_layer.html">
            
                    
                    11.3 Cloud layer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="Summary_11.html">
            
                <a href="Summary_11.html">
            
                    
                    11.4 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="Under_the_hood_of_Kubernetes.html">
            
                <a href="Under_the_hood_of_Kubernetes.html">
            
                    
                    12 Under the hood of Kubernetes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="Anatomy_of_a_Kubernetes_cluster_and_how_to_break_it.html">
            
                <a href="Anatomy_of_a_Kubernetes_cluster_and_how_to_break_it.html">
            
                    
                    12.1 Anatomy of a Kubernetes cluster and how to break it
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="Summary_of_key_components.html">
            
                <a href="Summary_of_key_components.html">
            
                    
                    12.2 Summary of key components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="Summary_12.html">
            
                <a href="Summary_12.html">
            
                    
                    12.3 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="Chaos_engineering_for_people.html">
            
                <a href="Chaos_engineering_for_people.html">
            
                    
                    13 Chaos engineering (for) people
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="Chaos_engineering_mindset.html">
            
                <a href="Chaos_engineering_mindset.html">
            
                    
                    13.1 Chaos engineering mindset
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="Getting_the_buy_in.html">
            
                <a href="Getting_the_buy_in.html">
            
                    
                    13.2 Getting the buy-in
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.3" data-path="Teams_as_distributed_systems.html">
            
                <a href="Teams_as_distributed_systems.html">
            
                    
                    13.3 Teams as distributed systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.4" data-path="Summary_13.html">
            
                <a href="Summary_13.html">
            
                    
                    13.4 Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.5" data-path="Where_to_go_from_here.html">
            
                <a href="Where_to_go_from_here.html">
            
                    
                    13.5 Where to go from here
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >10.3 Setting up a Kubernetes cluster</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="103-setting-up-a-kubernetes-cluster">10.3 Setting up a Kubernetes cluster</h1>
<p>Before we can continue with our scenario, you&#x2019;re going to need access to a working Kubernetes cluster. The beauty of Kubernetes, is that you can get the cluster from various providers, and it should behave exactly the same! All the examples in this chapter will work on any conformant clusters and I will mention where there might be potential caveats. Therefore you&#x2019;re free to pick whatever installation of Kubernetes is the most convenient for you.</p>
<p>For those who don&#x2019;t have a Kubernetes cluster handy, the easiest way to get started is to deploy a single-node, local mini-cluster on your local machine with Minikube (<a href="https://github.com/kubernetes/minikube" target="_blank">https://github.com/kubernetes/minikube</a>). Minikube is an official part of Kubernetes itself, and allows you to deploy a single node with single instances of all the Kubernetes control plane components inside of a virtual machine. It also takes care of the little-yet-crucial things like helping you easily access things running inside of the cluster.</p>
<p>Before continuing, please follow Appendix A to install Minikube. In this chapter, I&#x2019;ll assume you&#x2019;re following along with a Minikube installation on your laptop. I&#x2019;ll also mention whatever might be different if you&#x2019;re not. Everything in this chapter was tested on Minikube 1.12.3, and Kubernetes 1.18.3.</p>
<h2 id="1031-starting-a-cluster">10.3.1 Starting a cluster</h2>
<p>Depending on the platform, Minikube supports multiple virtualization options to run the actual VM with Kubernetes. The options differ for each platform and include:</p>
<ul>
<li>Linux: KVM or VirtualBox (running processes directly on the host is also supported)</li>
<li>macOS: HyperKit, VMware Fusion, Parallels or VirtualBox</li>
<li>Windows: Hyper-V or VirtualBox</li>
</ul>
<p>For our purposes, you can pick any of the supported options and it should work all the same. But because I already made you install VirtualBox for the previous chapters and it&#x2019;s a common denominator of all three supported platforms, I&#x2019;d recommend we stick with VirtualBox.</p>
<p>To start a cluster, all you need is the <code>minikube start</code> command. To specify the VirtualBox driver, use the <code>--driver</code> flag. Run the following command from a terminal to start a new cluster using VirtualBox:</p>
<pre><code class="lang-shell">minikube start --driver=virtualbox
</code></pre>
<p>The command might take a minute, because minikube needs to download the VM image for your cluster and then start a VM with that image. When it&#x2019;s done, you will see the output similar to the following. Someone took the time to pick relevant emoticons for each log message, so I took the time to respect that and copy verbatim. You can see that it used the VirtualBox driver like I requested and defaulted to give the VM 2 CPUs, 4GB of RAM and 2GB of storage. It&#x2019;s also running Kubernetes v1.18.3 on Docker 19.03.12 (all in bold font).</p>
<pre><code class="lang-shell">&#x1F604;  minikube v1.12.3 on Darwin 10.14.6 
&#x2728;  Using the virtualbox driver based on user configuration 
&#x1F44D;  Starting control plane node minikube in cluster minikube 
&#x1F525;  Creating virtualbox VM (CPUs=2, Memory=4000MB, Disk=20000MB) &#x2026; 
&#x1F433;  Preparing Kubernetes v1.18.3 on Docker 19.03.12 &#x2026; 
&#x1F50E;  Verifying Kubernetes components&#x2026; 
&#x1F31F;  Enabled addons: default-storageclass, storage-provisioner 
&#x1F3C4;  Done! kubectl is now configured to use &quot;minikube&quot;
</code></pre>
<p>To confirm that it started OK, try to list all pods running on the cluster. Run the following command in a terminal:</p>
<pre><code class="lang-shell">kubectl get pods -A
</code></pre>
<p>You will see the output just like the following, listing the different components that together make the Kubernetes control plane. We will cover in detail how they work later in this chapter. For now, this command working at all proves that the control plane works.</p>
<pre><code class="lang-shell">NAMESPACE     NAME                  READY   STATUS    RESTARTS   AGE 
kube-system   coredns-66bff467f8-62g9p           1/1     Running   0          5m44s 
kube-system   etcd-minikube         1/1     Running   0          5m49s 
kube-system   kube-apiserver-minikube            1/1     Running   0          5m49s 
kube-system   kube-controller-manager-minikube   1/1     Running   0          5m49s 
kube-system   kube-proxy-bwzcf      1/1     Running   0          5m44s 
kube-system   kube-scheduler-minikube            1/1     Running   0          5m49s 
kube-system   storage-provisioner                1/1     Running   0          5m49s
</code></pre>
<p>We&#x2019;re now ready to go. When you&#x2019;re done for the day and want to stop the cluster, use <code>minikube stop</code>, and to resume the cluster use <code>minikube start</code>.</p>
<p><div class="alert alert-info hints-alert"><div class="hints-icon"><i class="fa fa-info-circle"></i></div><div class="hints-container"><p><strong>NOTE GETTING KUBECTL HELP</strong></p>
<p>You can use the command kubectl --help to get help on all available commands in kubectl. If you&#x2019;d like more details on a particular command, use --help on that command. For example, to get help about the available options of the get command, just run kubectl get --help.</p>
</div></div></p>
<p>Time to get our hands dirty with the High Profile Project.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Whats_Kubernetes_in_7_minutes.html" class="navigation navigation-prev " aria-label="Previous page: 10.2 What’s Kubernetes (in 7 minutes)">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Testing_out_software_running_on_Kubernetes.html" class="navigation navigation-next " aria-label="Next page: 10.4 Testing out software running on Kubernetes">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"10.3 Setting up a Kubernetes cluster","level":"2.1.3","depth":2,"next":{"title":"10.4 Testing out software running on Kubernetes","level":"2.1.4","depth":2,"path":"docs/Testing_out_software_running_on_Kubernetes.md","ref":"docs/Testing_out_software_running_on_Kubernetes.md","articles":[]},"previous":{"title":"10.2 What’s Kubernetes (in 7 minutes)","level":"2.1.2","depth":2,"path":"docs/Whats_Kubernetes_in_7_minutes.md","ref":"docs/Whats_Kubernetes_in_7_minutes.md","articles":[]},"dir":"ltr"},"config":{"plugins":["page-toc-button","cnzz","hints","sitemap-general"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"search":{},"cnzz":{"style":"1","visible":true,"siteid":"1278605528"},"hints":{"danger":"fa fa-bug","info":"fa fa-info-circle","tip":"fa fa-sticky-note","working":"fa fa-cog fa-spin"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sitemap-general":{"prefix":"https://wangwei1237.gitee.io/chaos-engineering"},"fontsettings":{"theme":"white","family":"serif","size":2},"highlight":{},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"wangwei17","pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":16,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":true},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"isbn":"","variables":{},"title":"Chaos Engineering","links":{"sharing":{"all":null,"facebook":null,"google":null,"twitter":null,"weibo":null},"sidebar":{"17哥的个人网站":"https://wangwei1237.gitee.io/"}},"gitbook":"*","description":"Chaos-Engineering","extension":null},"file":{"path":"docs/Setting_up_a_Kubernetes_cluster.md","mtime":"2020-11-29T06:43:57.368Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-09T07:58:23.938Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-cnzz/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

